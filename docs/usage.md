# 拾取筛 · 游戏内使用说明

## 安装

1. 确认版本：本模组适用于 **Minecraft 1.12.2 + Forge**。
2. 将构建/下载得到的 `pickupfilter-*.jar` 放入 `mods/`（不要解压，直接放 `.jar` 文件；不要放 `*-sources.jar`）：
   - 单人/客户端：你的“实例目录”下的 `mods/`
   - 多人：**服务端与客户端都需要安装**（服务端负责执行过滤逻辑；客户端负责按键与配置界面）
   - 如果没有 `mods/` 文件夹：自己新建一个 `mods` 文件夹即可
3. 怎么找到“实例目录 / mods”：
   - 官方启动器（Minecraft Launcher）默认 `.minecraft`：
     - Windows：`%AppData%\\.minecraft\\mods`
     - macOS：`~/Library/Application Support/minecraft/mods`
     - Linux：`~/.minecraft/mods`
   - 多开启动器（MultiMC / Prism / HMCL / CurseForge 等）：在启动器里打开该实例的“文件夹/目录”，然后进入 `mods/`
   - 服务器：把 Jar 放到服务端根目录的 `mods/`，重启服务端
3. 进入世界后，首次会自动弹出“首次使用说明”界面（可从中直接打开配置）。
4. 验证是否生效：主菜单或游戏内按 `ESC` → `Mod 列表`，能看到 `Pickup Filter (拾取筛)` 即表示加载成功。

## 默认快捷键

可在“选项 → 控制 → 拾取筛”中自行改键。

- `O`：切换模式
- `P`：打开配置界面
- `K`：清除附近掉落物/地上箭矢（默认以玩家所在区块为中心，**2 区块半径**范围内的掉落物实体与射在地上的箭矢；可在配置文件调整）

## 全局配置（清除范围）

清除范围使用“全局配置文件”（与按玩家/存档保存的规则列表不同）：

- 文件：`config/pickupfilter-common.properties`
- 字段：`clear_drops.chunk_radius`（单位：区块；默认：`2`；范围：`0~16`）

## 三种模式怎么用（核心概念）

配置里维护的是“**匹配规则列表**”（哪些物品算“匹配”），不同模式对“匹配/不匹配”的处理不同：

- 注意：规则列表与模式是**按玩家、按存档（世界）保存**的：每个玩家在每个世界都有自己独立的一份配置。
- 规则列表分为两份：
  - **拾取匹配列表**：在“拾取匹配掉落物”模式下生效
  - **销毁匹配列表**：在“销毁匹配掉落物”模式下生效
  - 配置界面/物品匹配界面会显示并编辑“当前模式对应的列表”（需要编辑另一份列表时，先切到对应模式）

- **关闭**：不做任何处理，和原版一样。
- **拾取匹配掉落物**：只有“匹配规则列表”的物品才允许被拾取（相当于“白名单拾取”）。
  - 适合：只捡指定资源/材料，避免背包被杂物塞满。
- **销毁匹配掉落物**：玩家附近（约 1.5 格范围）出现“匹配规则列表”的掉落物会被自动销毁（相当于“黑名单销毁”）。
  - 适合：自动清理圆石/泥土/树叶等不需要的掉落物。

提示：同一套规则在两种模式下含义相反——切模式前先确认你这份规则是“想捡的”还是“想销毁的”。

## 打开配置界面并配置规则

按 `P` 打开配置界面：

- 左上按钮：`模式：xxx`（点击可在三种模式间循环；也可直接按 `O` 切换）
- 规则列表：显示当前规则（会以内部序列化形式展示）
- 输入框：按“用户输入格式”填写规则，然后点“添加规则”
- `添加手持物品`：把主手拿着的物品直接加入规则
- `删除选中`：删除列表里当前选中的一条
- 自动保存：添加/删除后会自动保存并同步到服务器（`应用` 仅作为手动同步兜底）
- `帮助`：返回首次使用说明界面

## 从背包快速选择物品（物品匹配 GUI）

在玩家背包界面（默认 `E`）会出现一个 “筛” 按钮（通常在背包右下角附近）：

- 点击 “筛” 打开“物品匹配”界面
- 如果 “筛” 按钮被其他模组按钮遮挡/重叠：按 `P` 打开配置界面，点击 `背包按钮：调整位置`，用方向键按钮微调偏移后再打开背包验证
- 顶部可切换：`拾取列表 / 销毁列表`（两份匹配列表互相独立，分别在对应模式下生效）
- 左侧背包区域左键点击物品图标：把该物品加入当前正在编辑的匹配列表
- 右侧匹配列表右键点击格子：移除条目
- 自动保存：添加/移除后会自动保存并同步到服务器
- 底部按钮：
  - `同步到服务器`：手动同步（一般不需要）
  - `清空列表`：清空当前列表的“物品条目”（保留未展示的高级规则）
  - `打开配置`：进入配置界面
  - `返回背包`：回到背包界面
- 快捷键：在背包界面把鼠标悬停在物品图标上，按 `A` 可直接把该物品加入“当前模式对应的列表”并同步到服务器（首次进入世界若还没同步到规则快照，会先显示“同步中…”，稍后再按一次即可）

### 规则输入格式（推荐）

输入框支持下列写法（不区分大小写）：

- `modid:item@meta`
  - 例：`minecraft:stone@0`
- `modid:item`（不写 `@meta` 默认匹配任意 meta）
  - 例：`minecraft:stone`
- `modid:*`（匹配该 mod 的所有物品）
  - 例：`minecraft:*`
- `*:item`（匹配任意 mod 下的同名物品）
  - 例：`*:dirt`
- `modid:item*`（`*` 作为通配符，可匹配多种物品名）
  - 例：`minecraft:log*`

“meta”说明：

- `@*` 或不写 `@meta`：匹配任意 meta
- `@0/@1/...`：精确匹配对应 meta

### 规则列表里看到的字符串是什么？

规则列表会显示内部存储格式：`modid:item:meta:wildcard`

- `meta` 为 `*` 表示任意 meta
- `wildcard` 为 `1/0` 表示该条规则的 `item` 是否启用通配符匹配

一般你只需要在输入框按“推荐格式”填写，列表显示的形式不同属于正常现象。

## 常见用法示例

- 只捡原版钻石/铁锭：切到“拾取匹配掉落物”，规则加：
  - `minecraft:diamond`
  - `minecraft:iron_ingot`
- 自动清理圆石：切到“销毁匹配掉落物”，规则加：
  - `minecraft:cobblestone`
- 想先试试看效果：先切到“关闭”，等规则配好后再切到目标模式。

## 排查问题

- 打开配置界面一直显示“同步中…”：通常是服务端未安装模组或网络同步未建立；确认服务端也装了同版本模组，并重新进入世界/服务器。
- 发现“拾取匹配掉落物”怎么什么都捡不到：这是白名单模式，请先把你想捡的物品加进规则列表并点“应用”。
